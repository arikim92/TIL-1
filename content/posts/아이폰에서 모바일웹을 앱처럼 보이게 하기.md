Title: 아이폰에서 모바일웹을 앱처럼 보이게 하기
Slug: how-to-make-iphone-webapp/
Date: 2015-12-20 22:20
Category: Dev
Tags: Dev, iPhone, HTML, JS, Front-End, Apple
Author: CHANN
<!--Summary: 테스트-->

> ~~웹을 앱이라고 사기치는 법에 대해 다룹니다~~

안드로이드에서는 앱 패킹(App Packing)[^1]이 어느정도 먹힌다. 아무래도 일반인들은 안드로이드 마켓에서 앱을 설치하는 것이 모바일 브라우져로 접속해서 홈 화면에 추가하는 것보다 익숙하니 비효율적[^2]일지라도 사업적인 측면에선 바람직한 선택일 수 있다.

그래서 아이폰에서도 비슷하게나마 앱처럼 보이게 하고 싶을 수도 있다. 하지만 앱스토어는 여러모로 '빡센 곳'[^3]이라 힘든데, 그럴 땐 `Safari 전용 WebApp` 설정을 해주면 된다. 이것으로 `홈 화면에 추가`하는 것만으로도  사용자에게 앱과 거의 유사한 경험을 제공할 수 있다. Rails라던가, Node.js 등을 활용한 `SPA`[^4] 에서 사용하도록 제공하는 기능 같은데, 그냥 생짜 HTML에도 먹히니 그냥 쓰면 된다. 사파리 모바일웹에서만 먹히니 아이폰 전용이라 할 수 있다.

사실 모바일웹으로 서비스를 이용 하다보면 검색창에 주소를 직접 칠 일이 많지가 않은데, 이 기능을 활용하면 주소창이 싹 사라지므로 공간이 넓어보이는 이점이 있으니 개인적으로는 일단 해두면 좋다고 생각한다. `홈 화면에 추가`를 해야만 작동하기 때문에 사실 바꿔도 사람들이 잘 모른다 (...)

아래는 예시 이미지이다.

![kuple-webapp](/content/images/2015/12/-----2015-12-20-19-08-24.png)


----------

## 사파리 웹앱 적용법
`<head> </head>` 사이에 아래와 같이 앱 아이콘 추가를 해 주고

```html
<link rel="apple-touch-icon" href="touch-icon-iphone.png">
<link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png">
<link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png">
<link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png">
```

웹앱 실행 시 인트로 화면이 뜨게 하고 싶으면 아래 코드를 더 추가하자. ~~근데 iPhone 4S 이후로 작동하지 않는 것 같다. 폰이 좋아진 탓에 로딩이 짧아져서 그런가...;;~~

```html
<link rel="apple-touch-startup-image" href="/startup.png">
```

아래 코드로 마무리하면 사파리에서 버튼과 주소창이 사라진다.
```html
<meta name="apple-mobile-web-app-capable" content="yes">
```

추가적으로, 위에 노티바 색깔도 아래와 같이 브랜드 컬러와 맞춰주자.
```html
<meta name="apple-mobile-web-app-status-bar-style" content="black">
```

아래와 같은 방식으로 다른 네이티브 앱으로 전환도 가능하다
```html
<a href="tel:1-408-555-5555">Call me</a>
```

자, 이름 끝인 줄 알았는데, `JS`코드 한 줄을 더 넣어주어야 한다. 이 상태에서 특정 링크를 누르면 정상적인 사파리 브라우져가 추가적으로 뜨기 때문. 

`</body>` 상단에 아래와 같은 자바스크립트를 추가해주자.

```html
<!-- Webapp Transition hotfix -->
<script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d    =d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standal    one")</script>
```

그럼 주소창과 버튼이 사라진 풀스크린의 모바일웹이 완성된다. 홈 화면에 추가해야만 작동하니 적용 후 홍보가 살짝 필요하다. 겉보기엔 진짜 그냥 평범한 앱처럼 보여서 일반인에게 사기치면 잘 속더라.

----------
## 추가: 아래의 코드 참고.

```html
<!doctype html>

<!-- http://taylor.fausak.me/2015/01/27/ios-8-web-apps/ -->

<html>
  <head>
    <title>iOS 8 web app</title>

    <!-- CONFIGURATION -->
    <!-- Allow web app to be run in full-screen mode. -->
    <meta name="apple-mobile-web-app-capable"
          content="yes">

    <!-- Make the app title different than the page title. -->
    <meta name="apple-mobile-web-app-title"
          content="iOS 8 web app">

    <!-- Configure the status bar. -->
    <meta name="apple-mobile-web-app-status-bar-style"
          content="black">

    <!-- Set the viewport. -->
    <meta name="viewport"
          content="initial-scale=1">

    <!-- Disable automatic phone number detection. -->
    <meta name="format-detection"
          content="telephone=no">

    <!-- ICONS -->
    <!-- iPad retina icon -->
    <link href="https://placehold.it/152"
          sizes="152x152"
          rel="apple-touch-icon-precomposed">

    <!-- iPad retina icon (iOS < 7) -->
    <link href="https://placehold.it/144"
          sizes="144x144"
          rel="apple-touch-icon-precomposed">

    <!-- iPad non-retina icon -->
    <link href="https://placehold.it/76"
          sizes="76x76"
          rel="apple-touch-icon-precomposed">

    <!-- iPad non-retina icon (iOS < 7) -->
    <link href="https://placehold.it/72"
          sizes="72x72"
          rel="apple-touch-icon-precomposed">

    <!-- iPhone 6 Plus icon -->
    <link href="https://placehold.it/180"
          sizes="120x120"
          rel="apple-touch-icon-precomposed">

    <!-- iPhone retina icon (iOS < 7) -->
    <link href="https://placehold.it/114"
          sizes="114x114"
          rel="apple-touch-icon-precomposed">

    <!-- iPhone non-retina icon (iOS < 7) -->
    <link href="https://placehold.it/57"
          sizes="57x57"
          rel="apple-touch-icon-precomposed">

    <!-- STARTUP IMAGES -->
    <!-- iPad retina portrait startup image -->
    <link href="https://placehold.it/1536x2008"
          media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 2)
                 and (orientation: portrait)"
          rel="apple-touch-startup-image">

    <!-- iPad retina landscape startup image -->
    <link href="https://placehold.it/1496x2048"
          media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 2)
                 and (orientation: landscape)"
          rel="apple-touch-startup-image">

    <!-- iPad non-retina portrait startup image -->
    <link href="https://placehold.it/768x1004"
          media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 1)
                 and (orientation: portrait)"
          rel="apple-touch-startup-image">

    <!-- iPad non-retina landscape startup image -->
    <link href="https://placehold.it/748x1024"
          media="(device-width: 768px) and (device-height: 1024px)
                 and (-webkit-device-pixel-ratio: 1)
                 and (orientation: landscape)"
          rel="apple-touch-startup-image">

    <!-- iPhone 6 Plus portrait startup image -->
    <link href="https://placehold.it/1242x2148"
          media="(device-width: 414px) and (device-height: 736px)
                 and (-webkit-device-pixel-ratio: 3)
                 and (orientation: portrait)"
          rel="apple-touch-startup-image">

    <!-- iPhone 6 Plus landscape startup image -->
    <link href="https://placehold.it/1182x2208"
          media="(device-width: 414px) and (device-height: 736px)
                 and (-webkit-device-pixel-ratio: 3)
                 and (orientation: landscape)"
          rel="apple-touch-startup-image">

    <!-- iPhone 6 startup image -->
    <link href="https://placehold.it/750x1294"
          media="(device-width: 375px) and (device-height: 667px)
                 and (-webkit-device-pixel-ratio: 2)"
          rel="apple-touch-startup-image">

    <!-- iPhone 5 startup image -->
    <link href="https://placehold.it/640x1096"
          media="(device-width: 320px) and (device-height: 568px)
                 and (-webkit-device-pixel-ratio: 2)"
          rel="apple-touch-startup-image">

    <!-- iPhone < 5 retina startup image -->
    <link href="https://placehold.it/640x920"
          media="(device-width: 320px) and (device-height: 480px)
                 and (-webkit-device-pixel-ratio: 2)"
          rel="apple-touch-startup-image">

    <!-- iPhone < 5 non-retina startup image -->
    <link href="https://placehold.it/320x460"
          media="(device-width: 320px) and (device-height: 480px)
                 and (-webkit-device-pixel-ratio: 1)"
          rel="apple-touch-startup-image">

    <!-- HACKS -->
    <!-- Prevent text size change on orientation change. -->
    <style>
      html {
        -webkit-text-size-adjust: 100%;
      }
    </style>
  </head>

  <body>
    <h1>iOS 8 web app</h1>
  </body>
</html>
```

----------

## 참고
1. [애플 공식 개발자 문서](https://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html)

----------

[^1]: `Webview`를 활용하여 앱으로 포장해서 안드로이드 마켓에 올리는 방식. 아이폰 앱스토어에서는 단칼에 거절당하는데 안드로이드에선 제법 통과되는 것 같다.
[^2]: 용량을 좀 더 차지하고, 불필요한 배터리 소모도 늘어난다. 아무튼 지저분해지고 유저 입장에서는 쓸데없는 앱이 많아봐야 영 좋지 않다.
[^3]: 개발자 연회비 12만원에 시어머니(?)만큼이나 깐깐한 앱스토어 심사 등 타이핑해봐야 손가락만 아프다.
[^4]: Single Page Application으로, 비동기식 방식으로 페이지 이동 없이 기능이 동작하도록 구성한 웹 어플리케션을 말한다.